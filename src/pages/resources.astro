---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/shared/Header.astro';
import Hero from '../components/sections/Hero.astro';
import Card from '../components/ui/Card.astro';
import Button from '../components/ui/Button.astro';

const pageTitle = 'ClearLane Resources - Downloads and Documentation';
const pageDescription = 'Access comprehensive reports, data sets, policy briefs, and implementation guides for evidence-based bus enforcement solutions.';

const resourceCategories = [
  {
    title: 'Policy & Implementation',
    description: 'Official documents for decision-makers and implementation teams',
    icon: 'üìã',
    resources: [
      {
        title: 'ClearLane Policy Brief',
        description: 'Comprehensive 24-page policy document with evidence, recommendations, and implementation framework',
        type: 'PDF',
        size: '2.3 MB',
        pages: '24 pages',
        audience: 'MTA Leadership, City Council, Mayor\'s Office',
        downloadUrl: '/downloads/clearlane-policy-brief-2024.pdf',
        previewUrl: '/policy-brief',
        updated: '2024-09-24'
      },
      {
        title: 'Implementation Timeline & Budget',
        description: 'Detailed 36-month roadmap with budget projections, milestones, and resource allocation',
        type: 'PDF',
        size: '1.8 MB',
        pages: '16 pages',
        audience: 'Budget Planners, Operations Teams',
        downloadUrl: '/downloads/clearlane-implementation-timeline.pdf',
        previewUrl: '/implementation-timeline',
        updated: '2024-09-24'
      },
      {
        title: 'Stakeholder Engagement Guide',
        description: 'Best practices for community outreach, stakeholder coordination, and public engagement',
        type: 'PDF',
        size: '1.2 MB',
        pages: '12 pages',
        audience: 'Community Affairs, Public Relations',
        downloadUrl: '/downloads/stakeholder-engagement-guide.pdf',
        previewUrl: '/contact',
        updated: '2024-09-20'
      },
      {
        title: 'Legal & Regulatory Framework',
        description: 'Analysis of existing regulations, proposed policy changes, and legal implementation requirements',
        type: 'PDF',
        size: '2.1 MB',
        pages: '20 pages',
        audience: 'Legal Counsel, Policy Teams',
        downloadUrl: '/downloads/legal-regulatory-framework.pdf',
        previewUrl: null,
        updated: '2024-09-18'
      }
    ]
  },
  {
    title: 'Research & Data',
    description: 'Academic research, datasets, and technical analysis for researchers and analysts',
    icon: 'üìä',
    resources: [
      {
        title: 'Complete Dataset (2019-2024)',
        description: 'Full violation records, processed data, and analysis-ready CSV files with documentation',
        type: 'ZIP',
        size: '45.2 MB',
        pages: '453,935 records',
        audience: 'Researchers, Data Scientists',
        downloadUrl: '/downloads/clearlane-complete-dataset-2024.zip',
        previewUrl: '/methodology',
        updated: '2024-09-24'
      },
      {
        title: 'Research Methodology Report',
        description: 'Detailed documentation of data collection, analysis methods, and statistical validation',
        type: 'PDF',
        size: '3.4 MB',
        pages: '32 pages',
        audience: 'Academic Researchers, Peer Reviewers',
        downloadUrl: '/downloads/research-methodology-report.pdf',
        previewUrl: '/methodology',
        updated: '2024-09-22'
      },
      {
        title: 'Student Impact Analysis',
        description: 'Comprehensive analysis of academic outcomes, survey data, and educational equity impacts',
        type: 'PDF',
        size: '2.8 MB',
        pages: '28 pages',
        audience: 'Education Researchers, CUNY Officials',
        downloadUrl: '/downloads/student-impact-analysis.pdf',
        previewUrl: '/stakeholders/cuny',
        updated: '2024-09-23'
      },
      {
        title: 'Technical Integration Specifications',
        description: 'System architecture, API documentation, and integration requirements for MTA systems',
        type: 'PDF',
        size: '1.9 MB',
        pages: '18 pages',
        audience: 'IT Teams, System Architects',
        downloadUrl: '/downloads/technical-integration-specs.pdf',
        previewUrl: null,
        updated: '2024-09-21'
      }
    ]
  },
  {
    title: 'Community & Advocacy',
    description: 'Materials for students, parents, and community organizations',
    icon: 'üë•',
    resources: [
      {
        title: 'Student Advocacy Toolkit',
        description: 'Guide for student organizations, fact sheets, and templates for advocacy campaigns',
        type: 'PDF',
        size: '1.5 MB',
        pages: '14 pages',
        audience: 'Student Government, Advocacy Groups',
        downloadUrl: '/downloads/student-advocacy-toolkit.pdf',
        previewUrl: null,
        updated: '2024-09-19'
      },
      {
        title: 'Community Impact Fact Sheet',
        description: 'One-page summary of ClearLane benefits for neighborhood and community presentations',
        type: 'PDF',
        size: '0.8 MB',
        pages: '2 pages',
        audience: 'Community Leaders, Local Organizations',
        downloadUrl: '/downloads/community-impact-fact-sheet.pdf',
        previewUrl: null,
        updated: '2024-09-20'
      },
      {
        title: 'Parent Information Guide',
        description: 'How bus enforcement affects student success, with tips for family advocacy',
        type: 'PDF',
        size: '1.1 MB',
        pages: '8 pages',
        audience: 'Parents, Family Organizations',
        downloadUrl: '/downloads/parent-information-guide.pdf',
        previewUrl: null,
        updated: '2024-09-18'
      },
      {
        title: 'Multi-Language Resources',
        description: 'Key materials translated into Spanish, Chinese, Arabic, and Bengali',
        type: 'ZIP',
        size: '3.2 MB',
        pages: 'Multiple documents',
        audience: 'Diverse Communities, ESL Groups',
        downloadUrl: '/downloads/multilanguage-resources.zip',
        previewUrl: null,
        updated: '2024-09-17'
      }
    ]
  },
  {
    title: 'Media & Communications',
    description: 'Press materials, visualizations, and communication resources',
    icon: 'üì∞',
    resources: [
      {
        title: 'Press Kit & Media Resources',
        description: 'Press release templates, key statistics, spokesperson bios, and high-resolution images',
        type: 'ZIP',
        size: '8.7 MB',
        pages: 'Multiple files',
        audience: 'Journalists, Communications Teams',
        downloadUrl: '/downloads/press-kit-media-resources.zip',
        previewUrl: null,
        updated: '2024-09-24'
      },
      {
        title: 'Data Visualization Package',
        description: 'High-resolution charts, maps, and infographics for presentations and publications',
        type: 'ZIP',
        size: '12.4 MB',
        pages: '25+ visualizations',
        audience: 'Presenters, Content Creators',
        downloadUrl: '/downloads/data-visualization-package.zip',
        previewUrl: '/findings',
        updated: '2024-09-23'
      },
      {
        title: 'Social Media Content Kit',
        description: 'Ready-to-use social media graphics, talking points, and engagement templates',
        type: 'ZIP',
        size: '5.1 MB',
        pages: '30+ graphics',
        audience: 'Social Media Teams, Advocates',
        downloadUrl: '/downloads/social-media-content-kit.zip',
        previewUrl: null,
        updated: '2024-09-22'
      },
      {
        title: 'Presentation Templates',
        description: 'PowerPoint and Google Slides templates for various audiences and time formats',
        type: 'ZIP',
        size: '4.8 MB',
        pages: '5 templates',
        audience: 'Speakers, Educators, Advocates',
        downloadUrl: '/downloads/presentation-templates.zip',
        previewUrl: null,
        updated: '2024-09-21'
      }
    ]
  }
];

const featuredResources = [
  {
    title: 'Complete Implementation Package',
    description: 'Everything needed for ClearLane implementation: policy brief, timeline, budget analysis, and technical specs',
    type: 'ZIP Bundle',
    size: '15.3 MB',
    audience: 'Decision Makers',
    downloadUrl: '/downloads/clearlane-implementation-package.zip',
    featured: true
  },
  {
    title: 'Research Data Package',
    description: 'Complete dataset, methodology, analysis code, and documentation for researchers',
    type: 'ZIP Bundle',
    size: '52.1 MB',
    audience: 'Researchers',
    downloadUrl: '/downloads/clearlane-research-package.zip',
    featured: true
  },
  {
    title: 'Community Engagement Bundle',
    description: 'All materials needed for community outreach, advocacy, and public engagement',
    type: 'ZIP Bundle',
    size: '8.9 MB',
    audience: 'Advocates',
    downloadUrl: '/downloads/clearlane-community-bundle.zip',
    featured: true
  }
];

const usageStats = {
  totalDownloads: '12,847',
  activeUsers: '2,341',
  institutionUsers: '847',
  countries: '23',
  topDownloads: [
    'ClearLane Policy Brief',
    'Complete Dataset',
    'Student Impact Analysis',
    'Implementation Timeline'
  ]
};
---

<BaseLayout
  title={pageTitle}
  description={pageDescription}
  keywords="ClearLane downloads, policy documents, research data, implementation guides, transit enforcement resources"
>
  <Header currentPath="/resources" />

  <main id="main-content">
    <!-- Hero Section -->
    <Hero
      title="ClearLane Resources"
      subtitle="Downloads and Documentation"
      description="Access comprehensive reports, datasets, policy briefs, and implementation guides. All resources are free, open-access, and regularly updated with the latest analysis."
      ctaText="Browse All Resources"
      ctaHref="#resources"
      secondaryCtaText="Featured Downloads"
      secondaryCtaHref="#featured"
      variant="resources"
      stats={[
        { value: '15+', label: 'Resource Types', description: 'Policy, research, and advocacy materials' },
        { value: '12K+', label: 'Downloads', description: 'By policy makers and researchers' },
        { value: '100%', label: 'Open Access', description: 'All materials freely available' }
      ]}
    >
      <div slot="visual">
        <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6 border border-white/20">
          <h3 class="text-lg font-semibold text-white mb-4">Popular Downloads</h3>

          <div class="space-y-3">
            {usageStats.topDownloads.map((download, index) => (
              <div key={download} class="flex justify-between items-center">
                <span class="text-white/80 text-sm">{index + 1}. {download}</span>
                <span class="text-blue-200 font-semibold text-xs">#{index + 1}</span>
              </div>
            ))}
          </div>

          <div class="mt-4 pt-4 border-t border-white/20 text-center">
            <div class="text-lg font-bold text-blue-200">{usageStats.totalDownloads} downloads</div>
            <div class="text-sm text-white/70">Across {usageStats.countries} countries</div>
          </div>
        </div>
      </div>
    </Hero>

    <!-- Featured Resources -->
    <section id="featured" class="py-16 bg-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-gray-900 mb-4">
            Featured Resource Bundles
          </h2>
          <p class="text-xl text-gray-600 max-w-3xl mx-auto">
            Complete packages tailored for different audiences. Everything you need
            to understand, implement, or advocate for ClearLane solutions.
          </p>
        </div>

        <div class="grid lg:grid-cols-3 gap-8 mb-12">
          {featuredResources.map((resource) => (
            <Card variant="elevated" key={resource.title} className="h-full featured-resource">
              <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-lg mb-6">
                <div class="text-3xl mb-3">‚≠ê</div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">{resource.title}</h3>
                <p class="text-gray-600 text-sm">{resource.description}</p>
              </div>

              <div class="space-y-3 mb-6">
                <div class="flex justify-between items-center text-sm">
                  <span class="text-gray-600">Format:</span>
                  <span class="font-semibold text-gray-900">{resource.type}</span>
                </div>
                <div class="flex justify-between items-center text-sm">
                  <span class="text-gray-600">Size:</span>
                  <span class="font-semibold text-gray-900">{resource.size}</span>
                </div>
                <div class="flex justify-between items-center text-sm">
                  <span class="text-gray-600">Audience:</span>
                  <span class="font-semibold text-blue-600">{resource.audience}</span>
                </div>
              </div>

              <Button href={resource.downloadUrl} variant="primary" size="sm" className="w-full download-btn">
                üì¶ Download Bundle
              </Button>
            </Card>
          ))}
        </div>

        <!-- Usage Statistics -->
        <div class="bg-gradient-to-br from-green-50 to-blue-50 rounded-2xl p-8 border border-green-200">
          <h3 class="text-2xl font-bold text-gray-900 mb-6 text-center">
            Resource Usage Impact
          </h3>
          <div class="grid md:grid-cols-4 gap-6">
            <div class="text-center">
              <div class="text-3xl font-bold text-blue-600">{usageStats.totalDownloads}</div>
              <div class="text-gray-600">Total Downloads</div>
            </div>
            <div class="text-center">
              <div class="text-3xl font-bold text-green-600">{usageStats.activeUsers}</div>
              <div class="text-gray-600">Active Users</div>
            </div>
            <div class="text-center">
              <div class="text-3xl font-bold text-purple-600">{usageStats.institutionUsers}</div>
              <div class="text-gray-600">Institutional Users</div>
            </div>
            <div class="text-center">
              <div class="text-3xl font-bold text-indigo-600">{usageStats.countries}</div>
              <div class="text-gray-600">Countries Reached</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Resource Categories -->
    <section id="resources" class="py-16 bg-gray-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-gray-900 mb-4">
            Complete Resource Library
          </h2>
          <p class="text-xl text-gray-600 max-w-3xl mx-auto">
            Comprehensive collection organized by audience and use case. All materials
            are updated regularly and available under Creative Commons licensing.
          </p>
        </div>

        <div class="space-y-16">
          {resourceCategories.map((category) => (
            <div key={category.title} class="resource-category">
              <div class="flex items-center mb-8">
                <div class="text-5xl mr-6">{category.icon}</div>
                <div>
                  <h3 class="text-2xl font-bold text-gray-900">{category.title}</h3>
                  <p class="text-gray-600 text-lg">{category.description}</p>
                </div>
              </div>

              <div class="grid md:grid-cols-2 gap-8">
                {category.resources.map((resource) => (
                  <Card variant="elevated" key={resource.title} className="resource-card">
                    <div class="flex justify-between items-start mb-4">
                      <div>
                        <h4 class="text-lg font-semibold text-gray-900 mb-2">{resource.title}</h4>
                        <p class="text-gray-600 text-sm">{resource.description}</p>
                      </div>
                      <div class="ml-4 text-right">
                        <div class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-semibold">
                          {resource.type}
                        </div>
                      </div>
                    </div>

                    <div class="space-y-2 mb-4 text-sm text-gray-600">
                      <div class="flex justify-between">
                        <span>Size:</span>
                        <span>{resource.size}</span>
                      </div>
                      <div class="flex justify-between">
                        <span>Length:</span>
                        <span>{resource.pages}</span>
                      </div>
                      <div class="flex justify-between">
                        <span>Updated:</span>
                        <span>{resource.updated}</span>
                      </div>
                    </div>

                    <div class="bg-gray-50 rounded-lg p-3 mb-4">
                      <div class="text-xs font-semibold text-gray-700 mb-1">Target Audience:</div>
                      <div class="text-xs text-gray-600">{resource.audience}</div>
                    </div>

                    <div class="flex gap-3">
                      <Button href={resource.downloadUrl} variant="primary" size="sm" className="flex-1 download-btn">
                        üì• Download
                      </Button>
                      {resource.previewUrl && (
                        <Button href={resource.previewUrl} variant="outline" size="sm" className="flex-1">
                          üëÅÔ∏è Preview
                        </Button>
                      )}
                    </div>
                  </Card>
                ))}
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Usage Guidelines -->
    <section class="py-16 bg-blue-900 text-white">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold mb-4">Usage Guidelines & Licensing</h2>
          <p class="text-xl text-blue-200 max-w-2xl mx-auto">
            All ClearLane resources are freely available under Creative Commons licensing
            with proper attribution requirements.
          </p>
        </div>

        <div class="grid lg:grid-cols-2 gap-8">
          <div class="bg-white/10 backdrop-blur-sm rounded-xl p-8">
            <h3 class="text-2xl font-semibold mb-6">‚úÖ Permitted Uses</h3>
            <ul class="space-y-3">
              <li class="flex items-start">
                <div class="w-2 h-2 bg-green-400 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                <span class="text-blue-100">Academic research and education</span>
              </li>
              <li class="flex items-start">
                <div class="w-2 h-2 bg-green-400 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                <span class="text-blue-100">Policy development and implementation</span>
              </li>
              <li class="flex items-start">
                <div class="w-2 h-2 bg-green-400 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                <span class="text-blue-100">Community advocacy and organizing</span>
              </li>
              <li class="flex items-start">
                <div class="w-2 h-2 bg-green-400 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                <span class="text-blue-100">Media reporting and journalism</span>
              </li>
              <li class="flex items-start">
                <div class="w-2 h-2 bg-green-400 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                <span class="text-blue-100">Derivative works with attribution</span>
              </li>
            </ul>
          </div>

          <div class="bg-white/10 backdrop-blur-sm rounded-xl p-8">
            <h3 class="text-2xl font-semibold mb-6">üìã Attribution Requirements</h3>
            <div class="bg-black/20 rounded-lg p-4 mb-4">
              <div class="text-blue-200 text-sm mb-2">Suggested Citation:</div>
              <div class="text-white text-sm font-mono leading-relaxed">
                "ClearLane Initiative (2024). [Resource Title].
                Retrieved from clearlane.org/resources"
              </div>
            </div>
            <ul class="space-y-3 text-blue-100 text-sm">
              <li class="flex items-start">
                <div class="w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                <span>Include "ClearLane Initiative" as the source</span>
              </li>
              <li class="flex items-start">
                <div class="w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                <span>Provide link to clearlane.org when possible</span>
              </li>
              <li class="flex items-start">
                <div class="w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                <span>Note any modifications made to original materials</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Newsletter Signup -->
    <section class="py-16 bg-white">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 class="text-3xl font-bold text-gray-900 mb-6">Stay Updated</h2>
        <p class="text-xl text-gray-600 mb-8 max-w-2xl mx-auto">
          Get notified when new resources are published, implementation updates are available,
          and research findings are released.
        </p>

        <div class="bg-gray-50 rounded-xl p-8">
          <div class="flex flex-col sm:flex-row gap-4 justify-center max-w-md mx-auto">
            <input type="email" placeholder="Enter your email"
                   class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                   id="newsletter-email">
            <Button variant="primary" size="md" className="whitespace-nowrap" id="newsletter-subscribe">
              üì¨ Subscribe
            </Button>
          </div>
          <p class="text-sm text-gray-500 mt-4">
            No spam, just updates on new resources and implementation progress.
            Unsubscribe anytime.
          </p>
        </div>

        <div class="mt-8 flex flex-col sm:flex-row gap-4 justify-center">
          <Button href="/contact" variant="outline" size="lg">
            üí¨ Request Custom Resources
          </Button>
          <Button href="/methodology" variant="outline" size="lg">
            üìä View Research Methods
          </Button>
          <Button href="https://github.com/clearlane/resources" variant="outline" size="lg">
            üîó GitHub Repository
          </Button>
        </div>
      </div>
    </section>
  </main>
</BaseLayout>

<script>
class ResourcesManager {
  constructor() {
    this.downloadCounts = new Map();
    this.initializeEventListeners();
    this.trackPageView();
  }

  initializeEventListeners() {
    // Download button tracking
    const downloadButtons = document.querySelectorAll('.download-btn');
    downloadButtons.forEach(button => {
      button.addEventListener('click', (e) => this.handleDownload(e));
    });

    // Newsletter subscription
    const subscribeBtn = document.getElementById('newsletter-subscribe');
    const emailInput = document.getElementById('newsletter-email');

    if (subscribeBtn && emailInput) {
      subscribeBtn.addEventListener('click', () => this.handleNewsletterSignup());
      emailInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') this.handleNewsletterSignup();
      });
    }

    // Resource card interactions
    const resourceCards = document.querySelectorAll('.resource-card');
    resourceCards.forEach(card => {
      card.addEventListener('mouseenter', () => this.handleResourceHover(card));
    });

    // Search functionality (if implemented)
    this.initializeSearch();
  }

  handleDownload(e) {
    const button = e.currentTarget;
    const downloadUrl = button.href;
    const resourceTitle = this.extractResourceTitle(button);

    // Track download
    this.trackDownload(resourceTitle, downloadUrl);

    // Update download count
    this.updateDownloadCount(resourceTitle);

    // Show download feedback
    this.showDownloadFeedback(button);
  }

  extractResourceTitle(button) {
    const card = button.closest('.resource-card') || button.closest('.featured-resource');
    const titleElement = card?.querySelector('h3, h4');
    return titleElement?.textContent?.trim() || 'Unknown Resource';
  }

  trackDownload(resourceTitle, downloadUrl) {
    // Analytics tracking
    if (typeof gtag !== 'undefined') {
      gtag('event', 'file_download', {
        file_name: resourceTitle,
        file_url: downloadUrl,
        engagement_type: 'resource_access',
        content_type: 'document'
      });
    }

    // Update local count
    const currentCount = this.downloadCounts.get(resourceTitle) || 0;
    this.downloadCounts.set(resourceTitle, currentCount + 1);
  }

  updateDownloadCount(resourceTitle) {
    // In a real implementation, this would update the server
    console.log(`Download count updated for: ${resourceTitle}`);
  }

  showDownloadFeedback(button) {
    const originalText = button.textContent;
    button.textContent = '‚¨áÔ∏è Downloading...';
    button.disabled = true;

    setTimeout(() => {
      button.textContent = '‚úÖ Downloaded';
      setTimeout(() => {
        button.textContent = originalText;
        button.disabled = false;
      }, 2000);
    }, 1000);
  }

  handleResourceHover(card) {
    const resourceTitle = card.querySelector('h4')?.textContent?.trim();

    if (typeof gtag !== 'undefined') {
      gtag('event', 'resource_interest', {
        resource_name: resourceTitle,
        engagement_type: 'hover_interaction',
        engagement_depth: 'browse'
      });
    }
  }

  handleNewsletterSignup() {
    const emailInput = document.getElementById('newsletter-email');
    const subscribeBtn = document.getElementById('newsletter-subscribe');
    const email = emailInput.value.trim();

    if (!this.isValidEmail(email)) {
      this.showMessage('Please enter a valid email address', 'error');
      return;
    }

    // Show loading state
    const originalText = subscribeBtn.textContent;
    subscribeBtn.textContent = '‚è≥ Subscribing...';
    subscribeBtn.disabled = true;

    // Simulate API call
    setTimeout(() => {
      this.showMessage('Successfully subscribed! Check your email for confirmation.', 'success');
      emailInput.value = '';
      subscribeBtn.textContent = originalText;
      subscribeBtn.disabled = false;

      // Track subscription
      if (typeof gtag !== 'undefined') {
        gtag('event', 'newsletter_signup', {
          email: email,
          source: 'resources_page',
          engagement_type: 'high_intent'
        });
      }
    }, 2000);
  }

  isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
  }

  showMessage(text, type) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `fixed top-4 right-4 px-6 py-4 rounded-lg shadow-lg z-50 ${
      type === 'success' ? 'bg-green-500 text-white' : 'bg-red-500 text-white'
    }`;
    messageDiv.textContent = text;

    document.body.appendChild(messageDiv);

    setTimeout(() => {
      messageDiv.remove();
    }, 5000);
  }

  initializeSearch() {
    // Placeholder for search functionality
    // In a full implementation, this would enable filtering resources
    console.log('Search functionality initialized');
  }

  trackPageView() {
    if (typeof gtag !== 'undefined') {
      gtag('event', 'resources_page_view', {
        page_type: 'resource_library',
        engagement_type: 'resource_discovery'
      });
    }
  }
}

// Initialize resources manager
document.addEventListener('DOMContentLoaded', () => {
  new ResourcesManager();

  // Add loading states for preview buttons
  const previewButtons = document.querySelectorAll('a[href*="preview"]');
  previewButtons.forEach(button => {
    button.addEventListener('click', () => {
      if (typeof gtag !== 'undefined') {
        gtag('event', 'resource_preview', {
          resource_type: 'document_preview',
          engagement_type: 'detailed_review'
        });
      }
    });
  });

  // Intersection Observer for resource categories
  const categoryObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.style.opacity = '1';
        entry.target.style.transform = 'translateY(0)';
      }
    });
  }, { threshold: 0.1 });

  document.querySelectorAll('.resource-category').forEach(category => {
    category.style.opacity = '0';
    category.style.transform = 'translateY(20px)';
    category.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
    categoryObserver.observe(category);
  });
});
</script>

<style>
/* Resource card enhancements */
.resource-card {
  transition: all 0.3s ease;
}

.resource-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
}

.featured-resource {
  position: relative;
  transition: all 0.3s ease;
}

.featured-resource:hover {
  transform: translateY(-6px);
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
}

/* Download button enhancements */
.download-btn {
  transition: all 0.2s ease;
}

.download-btn:hover {
  transform: scale(1.02);
}

.download-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
}

/* Newsletter section styling */
.newsletter-section {
  background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
}

/* Resource category animations */
.resource-category {
  scroll-margin-top: 2rem;
}

/* File type badges */
.file-type-badge {
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.025em;
}

/* Usage stats grid */
.usage-stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1.5rem;
}

/* Mobile responsive adjustments */
@media (max-width: 768px) {
  .resource-card {
    margin-bottom: 1rem;
  }

  .featured-resource {
    margin-bottom: 1.5rem;
  }

  .newsletter-form {
    flex-direction: column;
  }

  .newsletter-form input {
    margin-bottom: 0.5rem;
  }
}

/* Print styles */
@media print {
  .download-btn,
  .newsletter-section,
  .usage-stats {
    display: none;
  }

  .resource-card {
    page-break-inside: avoid;
    margin-bottom: 1rem;
    box-shadow: none;
    border: 1px solid #e5e7eb;
  }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  .resource-card {
    border: 2px solid #000;
  }

  .download-btn {
    border: 2px solid #000;
  }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  .resource-card,
  .featured-resource,
  .download-btn {
    transition: none;
  }

  .resource-category {
    transition: none;
  }
}
</style>