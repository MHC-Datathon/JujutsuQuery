---
/**
 * Research Findings Page - ClearLane Initiative
 * Key insights from data analysis of MTA bus enforcement violations
 */

import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/shared/Header.astro';
import Hero from '../components/sections/Hero.astro';
import Card from '../components/ui/Card.astro';
import Button from '../components/ui/Button.astro';
import DataVisualizationLayout from '../components/layout/DataVisualizationLayout.astro';
import TemporalChart from '../components/charts/TemporalChart.astro';

const pageTitle = 'Research Findings - ClearLane Initiative';
const pageDescription = 'Key insights from our analysis of 3.7 million MTA violation records: when, where, and why bus enforcement fails CUNY students.';

const keyFindings = [
  {
    title: 'The Problem is Local',
    icon: 'üìç',
    statistic: '90 locations',
    description: 'cause 90% of problems',
    details: 'Bus violations are highly concentrated. 90% of student-impacting violations occur at just 90 bus stops across NYC.'
  },
  {
    title: 'The Problem is Predictable',
    icon: '‚è∞',
    statistic: '7-10 AM',
    description: 'peak disruption hours',
    details: 'Violations peak during student commute hours (7-10 AM weekdays), directly disrupting "rolling study halls."'
  },
  {
    title: 'The Solution Works',
    icon: '‚úÖ',
    statistic: '+6.5%',
    description: 'speed improvement proven',
    details: 'Targeted ACE enforcement improved bus speeds by 6.5% on 5 routes. ClearLane can scale this success.'
  }
];

const enforcementParadox = {
  title: 'The Enforcement Paradox',
  description: 'Our analysis reveals a counterintuitive pattern: increased violations don\'t always correlate with better bus performance.',
  insights: [
    'Routes with more violations often show worse speed improvements',
    'Enforcement effectiveness varies dramatically by location and time',
    'Current blanket enforcement misses the most impactful opportunities'
  ]
};

const studentImpact = {
  title: 'Student Commute Disruption',
  description: 'CUNY students face systematic delays during their most productive study hours.',
  statistics: [
    { metric: '270,000+', label: 'CUNY students depend on NYC buses daily' },
    { metric: '2 hours', label: 'Average BxM10 commute time' },
    { metric: '83%', label: 'Violations concentrated at 90 locations' }
  ]
};

const spatialAnalysis = {
  title: 'Spatial Hotspot Analysis',
  description: 'Geographic clustering reveals where enforcement should be prioritized.',
  findings: [
    'Manhattan CBD shows highest violation density',
    'CUNY campus proximity correlates with violation frequency',
    'DBSCAN clustering identified 90 high-priority locations'
  ]
};

const temporalPatterns = {
  title: 'Temporal Pattern Analysis',
  description: 'Time-based analysis shows when enforcement is most needed.',
  patterns: [
    'Peak violations: 7-10 AM weekdays',
    'Academic calendar correlation: higher violations during semester',
    'Weekend patterns differ significantly from weekday patterns'
  ]
};

const predictiveInsights = {
  title: 'Predictive Modeling Results',
  description: 'Machine learning models identify the most impactful enforcement opportunities.',
  models: [
    'Random Forest: 85% accuracy in predicting violation hotspots',
    'Feature importance: time of day, proximity to CUNY, route type',
    'ROI projection: 12% speed improvement with targeted enforcement'
  ]
};
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <Header />
  
  <main>
    <!-- Hero Section -->
    <Hero
      title="Research Findings"
      subtitle="Data-Driven Insights"
      description="Our analysis of 3.7 million MTA violation records reveals clear patterns that can guide targeted enforcement to protect student study time."
      ctaText="View Methodology"
      ctaHref="/methodology"
      secondaryCtaText="See Solution"
      secondaryCtaHref="/solution"
      variant="research"
    />

    <!-- Key Findings Section -->
    <section class="py-16 bg-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
          <h2 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-6">
            Key Findings
          </h2>
          <p class="text-xl text-gray-600 max-w-3xl mx-auto">
            Three critical insights that transform how we understand bus enforcement failures
          </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-16">
          {keyFindings.map((finding) => (
            <Card className="text-center p-8 hover:shadow-lg transition-shadow">
              <div class="text-4xl mb-4 emoji-container" role="img" aria-label={`${finding.title} icon`}>{finding.icon}</div>
              <div class="text-3xl font-bold text-primary mb-2">{finding.statistic}</div>
              <div class="text-sm text-gray-500 uppercase tracking-wide mb-4">{finding.description}</div>
              <h3 class="text-xl font-semibold text-gray-900 mb-3">{finding.title}</h3>
              <p class="text-gray-600">{finding.details}</p>
            </Card>
          ))}
        </div>
      </div>
    </section>

    <!-- Data Visualization Section -->
    <DataVisualizationLayout
      title="When Student Commutes Are Most Disrupted"
      description="Bus lane violations by hour of day and day of week. Peak violations occur during morning student commute hours (7-10 AM)."
      visualizationType="temporal"
    >
      <TemporalChart highlightStudentHours={true} />
    </DataVisualizationLayout>

    <!-- Enforcement Paradox Section -->
    <section class="py-16 bg-gray-50">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-gray-900 mb-6">{enforcementParadox.title}</h2>
          <p class="text-xl text-gray-600">{enforcementParadox.description}</p>
        </div>

        <div class="bg-white rounded-lg shadow-md p-8">
          <ul class="space-y-4">
            {enforcementParadox.insights.map((insight) => (
              <li class="flex items-start">
                <div class="w-2 h-2 bg-red-500 rounded-full mr-4 mt-2 flex-shrink-0"></div>
                <p class="text-gray-700">{insight}</p>
              </li>
            ))}
          </ul>
        </div>
      </div>
    </section>

    <!-- Student Impact Section -->
    <section class="py-16 bg-white">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-gray-900 mb-6">{studentImpact.title}</h2>
          <p class="text-xl text-gray-600">{studentImpact.description}</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          {studentImpact.statistics.map((stat) => (
            <div class="text-center">
              <div class="text-4xl font-bold text-primary mb-2">{stat.metric}</div>
              <div class="text-gray-600">{stat.label}</div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Spatial Analysis Section -->
    <section class="py-16 bg-gray-50">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-gray-900 mb-6">{spatialAnalysis.title}</h2>
          <p class="text-xl text-gray-600">{spatialAnalysis.description}</p>
        </div>

        <div class="bg-white rounded-lg shadow-md p-8">
          <ul class="space-y-4">
            {spatialAnalysis.findings.map((finding) => (
              <li class="flex items-start">
                <div class="w-2 h-2 bg-blue-500 rounded-full mr-4 mt-2 flex-shrink-0"></div>
                <p class="text-gray-700">{finding}</p>
              </li>
            ))}
          </ul>
        </div>
      </div>
    </section>

    <!-- Temporal Patterns Section -->
    <section class="py-16 bg-white">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-gray-900 mb-6">{temporalPatterns.title}</h2>
          <p class="text-xl text-gray-600">{temporalPatterns.description}</p>
        </div>

        <div class="bg-white rounded-lg shadow-md p-8">
          <ul class="space-y-4">
            {temporalPatterns.patterns.map((pattern) => (
              <li class="flex items-start">
                <div class="w-2 h-2 bg-green-500 rounded-full mr-4 mt-2 flex-shrink-0"></div>
                <p class="text-gray-700">{pattern}</p>
              </li>
            ))}
          </ul>
        </div>
      </div>
    </section>

    <!-- Predictive Insights Section -->
    <section class="py-16 bg-gray-50">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-gray-900 mb-6">{predictiveInsights.title}</h2>
          <p class="text-xl text-gray-600">{predictiveInsights.description}</p>
        </div>

        <div class="bg-white rounded-lg shadow-md p-8">
          <ul class="space-y-4">
            {predictiveInsights.models.map((model) => (
              <li class="flex items-start">
                <div class="w-2 h-2 bg-purple-500 rounded-full mr-4 mt-2 flex-shrink-0"></div>
                <p class="text-gray-700">{model}</p>
              </li>
            ))}
          </ul>
        </div>
      </div>
    </section>

    <!-- Call to Action Section -->
    <section class="py-16 bg-secondary text-white">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 class="text-3xl sm:text-4xl font-bold mb-6">
          Ready to Implement the Solution?
        </h2>
        <p class="text-xl text-secondary-light mb-8 max-w-2xl mx-auto">
          Our research provides the data-driven foundation for targeted enforcement that protects student study time.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <Button href="/solution" variant="primary" size="lg">
            View Complete Solution
          </Button>
          <Button href="/methodology" variant="ghost" size="lg" className="text-white border-white">
            See Research Details
          </Button>
        </div>
      </div>
    </section>
  </main>
</BaseLayout>
